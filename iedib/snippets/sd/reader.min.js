window.IB = window.IB || {}; window.IB.sd = window.IB.sd || {}; !function(e){var n=window.speechSynthesis,t=null!=n&&null!=window.SpeechSynthesisUtterance,o=window.SpeechRecognition||window.webkitSpeechRecognition,i=window.SpeechRecognitionEvent||window.webkitSpeechRecognitionEvent,s=null!=o&&null!=i;IB.supported2=s;var c=function(e,n){e=(e||"").toLowerCase();for(var t=0,o=null,i=(n||[]).length;i>t&&null==o;)n[t].lang.toLowerCase()==e&&(o=n[t]),t++;return o},l=[],r=!0,a=function(){if(window.addEventListener("unload",function(e){window.speechSynthesis.cancel()}),l=window.speechSynthesis.getVoices(),IB.SHOW_MUTE_BTN){var e=document.querySelector(".no-overflow");if(e.style.position="relative",e){var n=document.createElement("span");n.style.position="absolute",n.style.right="10px",n.style.fontSize="125%",n.style.color="lightgray",n.style.top="0",n.style.cursor="pointer",n.title="Desconnecta la veu";var t=document.createElement("i");t.classList.add("fas","fa-volume"),n.append(t),e.append(n),n.addEventListener("click",function(e){e.preventDefault(),r?(window.speechSynthesis.cancel(),t.classList.remove("fa-volume"),t.classList.add("fa-volume-mute"),n.title="Desconnecta la veu"):(t.classList.add("fa-volume"),t.classList.remove("fa-volume-mute"),n.title="Activa la veu"),r=!r})}}},u=["ca-ES","es-ES"];e.reader=function(n,o){if(o=o||0,t&&r){if(!l.length)return void(3>o&&setTimeout(function(){e.reader(n,o+1)},800));for(var i=null,s=null,a=0,d=u.length;d>a&&(s=u[a],i=c(u[a],l),null==i);a++);i&&n[s]||console.error("No voice/text found"),window.speechSynthesis.cancel();var v=n[s],p=new SpeechSynthesisUtterance(v);p.voice=i,window.speechSynthesis.speak(p)}},e.speechRecognition=function(e,n,t){if(t=t||!1,!s)return console.error("Speech recognition not supported"),void(e&&e(null,0));var i=new o;i.lang=n,i.interimResults=!1,i.maxAlternatives=1,i.start(),i.onresult=function(n){var t=n.results[0][0].transcript,o=n.results[0][0].confidence;e&&e(t,o)}},t?(n.getVoices()||[]).length?a():n.addEventListener("voiceschanged",function(){a()}):console.error("Sorry: SpeechSynthesis not supported in browser.")}(window.IB);
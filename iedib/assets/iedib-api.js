function myLocale(e){return e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}window.iedibAPI=window.iedibAPI||{DEBUG:!1},window.iedibAPI.insertScript=function(e,t,i,n){for(var o,a,r=document.getElementsByTagName("script"),d=0;d<r.length;d++)if(r[d].src===e){o=!0;break}o||((a=document.createElement("script")).src=e,a.type="text/javascript",n&&(a.async=!0,"function"==typeof n)&&(a.onload=function(){n()}),i?document.body.appendChild(a):t&&r.length?(i=r[0]).parentNode.insertBefore(a,i):document.head.appendChild(a))},window.iedibAPI.insertScriptBody=function(e){window.iedibAPI.insertScript(e,!1,!0)},window.iedibAPI.parseUrlParams=function(e){for(var t={},i=e.substring(1).split("&"),n=0;n<i.length;n++){var o=i[n].split("=");o[0]&&(t[o[0]]=o[1]||!0)}return t},window.iedibAPI.isBoost=function(){return null!=document.querySelector('div[data-region="drawer-toggle"]')},window.iedibAPI.getPageInfo=function(){var e,t,i,n,o,a,r,d,c;return document.querySelector?((o=document.querySelector("[data-userid]"))&&(e=o.getAttribute("data-userid")),c=null!=(o=document.querySelector('.footer-section .logininfo a[href*="profile.php"]')),o?t=o.innerText:(o=document.getElementsByClassName("usertext"))&&o.length&&(t=o[0].innerText),e||(e=-1,t="Usuari convidat"),o={},(i=(o=location.search?iedibAPI.parseUrlParams(location.search):o).chapterid)||((d=document.querySelector('input[name="chapterid"]'))?i=d.value:(d=document.querySelector("section.block_book_toc a:first-child"))&&(n=d.href,i=iedibAPI.parseUrlParams(n).chapterid||"")),(n=o.id)||(d=document.querySelector('div.singlebutton > form > input[name="id"]'))&&(n=d.value),o="",(o=0<(a=(d=document.cookie||"").indexOf("="))?d.substr(a+1):o)&&0<o.indexOf(";")&&(moduleSession=o.split(";")[0]),d=M.cfg.courseId,a=0,c?(a=null!=document.querySelector('form.editmode-switch-form input[type="checkbox"].custom-control-input')?1:0,(c=document.querySelector("#page-navbar ol.breadcrumb li.breadcrumb-item:first-child > a"))&&(r=c.innerText)):(a=null!=document.querySelector(".teacherdash.nav-item.nav-link")?1:0,(c=document.querySelector(".homelink > a"))&&(r=c.innerText,c="?"+(c.href.split("?")[1]||""),d=iedibAPI.parseUrlParams(c).id)),c=(location.href.split("?")[0]||"").replace("/mod/book/view.php",""),window.iedibAPI.lliurament=window.iedibAPI.lliurament||{},{userId:e,userFullname:t,bookId:n,chapterId:i,assignNum:window.iedibAPI.lliurament.id||0,assignName:window.iedibAPI.lliurament.title||"",courseName:r,courseId:d,isTeacher:a,site:c,moodleSession:o}):{}},window.iedibAPI.waitForWindow=function(e,t,i){function n(){!i&&void 0!==window[e]||i&&typeof window[e]==i?(o&&window.clearInterval(o),t&&t()):o=o||window.setInterval(n,250)}var o;"$"===e&&window.iedibAPI.waitForWindow("require",function(){window.require(["jquery"],function($){window.$||(window.$=$,window.jQuery=$),t&&t()})},"function");n()},window.iedibAPI.require=function(e,t){window.iedibAPI.waitForWindow("require",function(){window.require(e,function(){t&&t.apply(null,Array.prototype.slice.call(arguments))})},"function")},window.iedibAPI.createStyleSheet=function(e,t){var i;t&&document.getElementById(t)||((i=document.createElement("style")).type="text/css",i.innerHTML=e,t&&(i.id=t),document.getElementsByTagName("head")[0].appendChild(i))},window.iedibAPI.createLinkSheet=function(e,t){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=e,document.getElementsByTagName("head")[0].appendChild(i)},window.iedibAPI.addBookEvent=function(e,t,i){return e.attachEvent?e.attachEvent("on"+t,i):e.addEventListener(t,i,!1)},window.iedibAPI.ready=function(e){"complete"===document.readyState||"interactive"===document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e,!1):window.attachEvent?window.attachEvent("onload",e):e()},window.iedibAPI.convertTimeLapse=function(e){var t,i,n;return e?(e=(e=(e=(e-=86400*(t=Math.floor(e/86400)))-3600*(i=Math.floor(e/3600)%24))-60*(n=Math.floor(e/60)%60))%60,t?t+" d  "+i+" h":i?i+" h  "+n+" min":n?n+" min  "+e+" s":e+" s"):"mai"},window.iedibAPI.parseDate=function(e){var e=e.replace(/ /g," ").split(" "),t="-",t=(0<e[0].indexOf("/")&&(t="/"),e[0].split(t)),e=e[1].split(":");return new Date(t[0],t[1]-1,t[2],e[0]||0,e[1]||0)};var aiHook,main,assistantURL,pageInfo=window.iedibAPI.getPageInfo(),cId=pageInfo.courseId+"",isBAT1="55"===cId,isBAT2="56"===cId||"102"===cId;(isBAT1||isBAT2)&&((aiHook=document.querySelector('div[role="main"] div.ai-course-summarise-controls'))||(main=document.querySelector('div[role="main"]'))&&((aiHook=document.createElement("DIV")).classList.add("ai-course-summarise-controls","pt-3","pb-3"),main.prepend(aiHook)),aiHook.innerHTML='<a href="'+(assistantURL=isBAT1?"https://chatgpt.com/g/g-6852662ed1bc81919120a6237e44ec61-assistent-de-matematiques-i":"https://chatgpt.com/g/g-68526aaaba9c8191aa8c6eecd60372ed-assistent-de-matematiques-ii")+'" target="_blank" class="btn btn-outline-secondary" data-toggle="tooltip" data-original-title="Demana ajuda a l\'assistent del curs"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20" height="20" fill="#818a95"><path d="M64 416L168.6 180.7c15.3-34.4 40.3-63.5 72-83.7l146.9-94c3-1.9 6.5-2.9 10-2.9C407.7 0 416 8.3 416 18.6l0 1.6c0 2.6-.5 5.1-1.4 7.5L354.8 176.9c-1.9 4.7-2.8 9.7-2.8 14.7c0 5.5 1.2 11 3.4 16.1L448 416l-207.1 0 11.8-35.4 40.4-13.5c6.5-2.2 10.9-8.3 10.9-15.2s-4.4-13-10.9-15.2l-40.4-13.5-13.5-40.4C237 276.4 230.9 272 224 272s-13 4.4-15.2 10.9l-13.5 40.4-40.4 13.5C148.4 339 144 345.1 144 352s4.4 13 10.9 15.2l40.4 13.5L207.1 416 64 416zM279.6 141.5c-1.1-3.3-4.1-5.5-7.6-5.5s-6.5 2.2-7.6 5.5l-6.7 20.2-20.2 6.7c-3.3 1.1-5.5 4.1-5.5 7.6s2.2 6.5 5.5 7.6l20.2 6.7 6.7 20.2c1.1 3.3 4.1 5.5 7.6 5.5s6.5-2.2 7.6-5.5l6.7-20.2 20.2-6.7c3.3-1.1 5.5-4.1 5.5-7.6s-2.2-6.5-5.5-7.6l-20.2-6.7-6.7-20.2zM32 448l448 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg> Assistent IA</a>'),window.iedibAPI.require(["jquery"],function($){var r=$(".iedib-restricted-access");r.length&&$.ajax({method:"GET",url:"https://piworld.es/iedibapi/date",dataType:"json"}).done(function(e){for(var t=new Date(e),i=0,n=r.length;i<n;i++){var o=$(r[i]),a=window.iedibAPI.parseDate(o.attr("data-fromdate")),o=o.find(".pw-resolucio");pageInfo.isTeacher?(o.css("display",""),t<a?o.css("background","lightgray"):o.css("background","#eefbff")):a<=t?(o.css("display",""),o.css("background","#eefbff")):(o.css("display",""),o.css("background","lightgray"),o.html("<p>S'obrirà la solució dia "+myLocale(a)+"</p>"))}})},"function");
